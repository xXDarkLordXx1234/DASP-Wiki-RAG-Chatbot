%META:TOPICINFO{author="BaseUserMapping_999" date="1360762006" format="1.1" reprev="1" version="2"}%
%META:TOPICPARENT{name="IvanGalkinWork"}%
<!-- @page { size: 21cm 29.7cm; margin: 2cm } P { margin-bottom: 0.21cm } -->

<font face="Albany, sans-serif"><font size="4">DataMachine &ndash; Programmablauf, Probleme und Lösungsvorschläge</font></font>

   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Entpacken der Dateien <span style="background: #ffff00 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">{LANG}wiki-{TIMESTAMP}-categorylinks.sql.gz</span> und <span style="background: #ffff00 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">{LANG}wiki-{TIMESTAMP}-pagelinks.sql.gz</span>, wodurch entsprechende temporäre Files entstehen</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">%TEMPDIRECTORY%/{LANG}wiki-{TIMESTAMP}-categorylinks.sql</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">%TEMPDIRECTORY%/{LANG}wiki-{TIMESTAMP}-pagelinks.sql</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Verwendung der Klasee XML2SQL, bzw. der Klasse org.mediawiki.dumper.Dumper um die Datei <span style="background: #ffff00 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">{LANG}wiki-{TIMESTAMP}-pages-meta-history.xml.bz2</span> zu entpacken und aus dem XML in SQL-Format umzuwandeln. Ergebnis &ndash; temporäre Datei </font></font>%ENDCOLOR% </p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">%TEMPDIRECTORY%/{LANG}wiki-{TIMESTAMP}-pages-meta-history.sql</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Die SQL-Datei aus dem zweiten Schritt wird mithilfe der statischen Klasse SQL2TXT bearbeitet, woraus 3 temporäre Dateien entstehen</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">&bdquo;<font face="Thorndale AMT, serif"><font size="3">%TEMPDIRECTORY%/page.txt&ldquo;, </font></font></span>%ENDCOLOR% </p>
      1 <p>%BLACK%<span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">&bdquo;<font face="Thorndale AMT, serif"><font size="3">%TEMPDIRECTORY%/text.txt&ldquo;, </font></font></span>%ENDCOLOR% </p>
      1 <p>%BLACK%<span style="background: #ff3366 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">&bdquo;<font face="Thorndale AMT, serif"><font size="3">%TEMPDIRECTORY%/revision.txt&ldquo; </font></font></span>%ENDCOLOR% </p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Bearbeitung der &bdquo;%TEMPDIRECTORY%/revision.txt&ldquo; (processRevision()) und das Ausfüllen der HashMap mit allen Artikel-Änderungen.</font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Parsen der Datei &bdquo;%TEMPDIRECTORY%/page.txt&ldquo; (processPage()), Speicherung der Ergebnisse</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">&bdquo;<font face="Thorndale AMT, serif"><font size="3">Category.txt&ldquo;</font></font></span>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Parsen der Datei &bdquo;%TEMPDIRECTORY%/{LANG}wiki-{TIMESTAMP}-categorylinks.sql&ldquo; (processCategoryLinks()), Speicherung der Ergebnisse</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">page_categories.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">category_pages.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">category_inlinks.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">category_outlinks.txt</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Parsen der Datei &bdquo;%TEMPDIRECTORY%/{LANG}wiki-{TIMESTAMP}-pagelinks.sql&ldquo; (parocessPageLinks()), Speicherung der Ergebnisse </font></font>%ENDCOLOR% </p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">page_inlinks.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">page_outlinks.txt</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Parsen der Datei &bdquo;%TEMPDIRECTORY%/text.txt&ldquo; (processText()), Speicherung der Ergebnisse</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Page.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">PageMapLine.txt</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">page_redirects.txt</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Speicherung der Beschreibung (writeMetedata())</font></font>%ENDCOLOR%</p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: #008000 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">MetaData.txt</span></font></font>%ENDCOLOR%</p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3">Entfernung der temporalen Dateien</font></font>%ENDCOLOR%</p>

%BLACK%<font face="Thorndale AMT, serif"><font size="3"> *Legende*: </font></font>%ENDCOLOR%

%BLACK%<font face="Thorndale AMT, serif"><font size="3">GELB Wikipedia Dumps</font></font>%ENDCOLOR%

%BLACK%<font face="Thorndale AMT, serif"><font size="3">ROT Temporäre Dateien</font></font>%ENDCOLOR%

%BLACK%<font face="Thorndale AMT, serif"><font size="3">GRÜN Output-Dateien</font></font>%ENDCOLOR%

%BLACK%<font face="Thorndale AMT, serif"><font size="3">Jeder Schritt der Schritte 5 bis 9 erstellt so viel Dateien, wie viel Wikipdia-Snapshots gewünscht wurden.</font></font>%ENDCOLOR%

%BLACK%<font face="Thorndale AMT, serif"><font size="3"> *Schlussfolgerung:* </font></font>%ENDCOLOR%
   1 <p><font face="Thorndale AMT, serif"><font size="3">Es ist nicht notwendig, die Dateien <span style="background: #ffff00 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">{LANG}wiki-{TIMESTAMP}-categorylinks.sql.gz</span><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial"> und </span><span style="background: #ffff00 none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">{LANG}wiki-{TIMESTAMP}-pagelinks.sql.gz </span><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">im ersten Schritt zu entpacken, weil es möglich ist die genannte Dateien in den Schritten 6 und 7 durch den Einsatz der Java-Klasse</span>%BLACK%<span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial"> </span>%ENDCOLOR%%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">GZIPInputStream direkt aus der komprimierten Datei zu parsen. Dies wurde erfolgreich mit Klasse BufferedReaderFactory eingesetzt.</span></span>%ENDCOLOR%</font></font></p>
   1 <p><font face="Thorndale AMT, serif"><font size="3">%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Die Verwendung der Klasse org.mediawiki.dumper.Dumper (Schritt 2) zwingt uns</span></span>%ENDCOLOR%</font></font></p> 
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">entweder BZ2 oder entpackte Dateien zu verwenden (10 Mal größer als 7Zip-Archiv)</span></font></font>%ENDCOLOR%</p>
      1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Ergebnisse der XML-&gt;SQL Konvertierung auf der Festplatte zu speichern (Äquivalent der kompletten entpacken) </span></font></font>%ENDCOLOR% </p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Die SQL2TXT-Konvertierung ist so entwickelt, dass die Ergebnis-Daten auch auf der Festplatte gespeichert werden sollen. Diese Tatsache ist einem nochmaligen Entpacken ähnlich. </span></font></font>%ENDCOLOR% </p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Dadurch entstehende Datenmengen verhindern die Bearbeitung größerer Wikipediaen</span></font></font>%ENDCOLOR%</p>

%BLACK%<font face="Thorndale AMT, serif"><font size="3"> *Lösungsvorschläge* </font></font>%ENDCOLOR%
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Entwicklung eines 7Zip-Entpackers. Da es momentan kompliziert ist einen funktionsfähigen Java-Code zu finden, ist es möglich folgendes Schema zu verwenden: </span></font></font>%ENDCOLOR% </p> 
      1 <p><font face="Thorndale AMT, serif"><font size="3">%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Process proc = Runtime.</span></span>%ENDCOLOR%%BLACK%<span style="text-decoration: none"><em><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">getRuntime</span></em></span>%ENDCOLOR%%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">().exec(&bdquo;7z[.exe] e -so &ldquo;.concat(archiveFilename));</span></span>%ENDCOLOR%</font></font></p>
      1 <p><font face="Thorndale AMT, serif"><font size="3">%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Verwendung von Ouput-Streams des </span></span>%ENDCOLOR%%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Originalentpackers InputStream input</span></span>%ENDCOLOR%%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial"> = proc.getInputStream();</span></span>%ENDCOLOR%</font></font></p> <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Dieses Schema ist leicht an jedes Betriebssystem anzupassen, für das ein 7Zip Entpacker implementiert ist</span></font></font>%ENDCOLOR%</p>
   1 <p><font face="Thorndale AMT, serif"><font size="3">%BLACK%<span style="text-decoration: none"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Anstatt die Klasse org.mediawiki.dumper.Dumper, die Klassen XmlDumpWriter xmldDumpReader zu verwenden, die Stream-Konzepte unterstützen, und dadurch nicht aus einer Datei, sondern aus einem dem Stream lesen und in einen Stream schreiben können. (S. Punkt 1)</span></span>%ENDCOLOR%</font></font></p>
   1 <p>%BLACK%<font face="Thorndale AMT, serif"><font size="3"><span style="background: transparent none repeat scroll 0% 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial">Grundsätzlich wo es möglich ist Dateien mit den Streams ersetzen. Dadurch kann man es versuchen, die temporäre Dateien überhaupt zu vermeiden</span></font></font>%ENDCOLOR%</p>